<p align="center">
  <img src="https://img.shields.io/badge/A4AD-Comment%20Service-E0234E?style=for-the-badge&logo=nestjs&logoColor=white" alt="A4AD Comment Service">
</p>

<p align="center">
  <img src="https://img.shields.io/badge/NestJS-10+-E0234E?style=flat-square&logo=nestjs&logoColor=white" alt="NestJS">
  <img src="https://img.shields.io/badge/TypeScript-5.0+-3178C6?style=flat-square&logo=typescript&logoColor=white" alt="TypeScript">
  <img src="https://img.shields.io/badge/MongoDB-7+-47A248?style=flat-square&logo=mongodb&logoColor=white" alt="MongoDB">
  <img src="https://img.shields.io/badge/License-MIT-green?style=flat-square" alt="License">
  <img src="https://img.shields.io/badge/Status-Early%20Development-orange?style=flat-square" alt="Status">
</p>

---

## üìù –û–ø–∏—Å–∞–Ω–∏–µ

**Comment Service** —É–ø—Ä–∞–≤–ª—è–µ—Ç –¥—Ä–µ–≤–æ–≤–∏–¥–Ω—ã–º–∏ –æ–±—Å—É–∂–¥–µ–Ω–∏—è–º–∏ –∏ –æ—Ç–≤–µ—Ç–∞–º–∏ –¥–ª—è —Ñ–æ—Ä—É–º–∞ A4AD. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –¥–µ—Ä–µ–≤—å—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤, –º—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ, –ª–∞–π–∫–∏ –Ω–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ —Å–æ–±—ã—Ç–∏—è Kafka. –ü–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ MongoDB –¥–ª—è –≥–∏–±–∫–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.

---

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üí¨ **–î—Ä–µ–≤–æ–≤–∏–¥–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏** ‚Äî –°–∏—Å—Ç–µ–º–∞ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ —Å –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –≥–ª—É–±–∏–Ω–æ–π
- üå≥ **–î–µ—Ä–µ–≤—å—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤** ‚Äî –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–µ—Ä–∞—Ä—Ö–∏–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
- üëç **–õ–∞–π–∫–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤** ‚Äî –°–∏—Å—Ç–µ–º–∞ –ª–∞–π–∫–æ–≤ —Å —Å—á—ë—Ç—á–∏–∫–∞–º–∏
- üóëÔ∏è **–ú—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ** ‚Äî –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø–æ–º–µ—á–∞—é—Ç—Å—è –∫–∞–∫ —É–¥–∞–ª—ë–Ω–Ω—ã–µ, –Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
- üìÑ **–ü–∞–≥–∏–Ω–∞—Ü–∏—è** ‚Äî –ö—É—Ä—Å–æ—Ä–Ω–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è –¥–ª—è –±–æ–ª—å—à–∏—Ö –≤–µ—Ç–æ–∫
- üîç **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —É–ø–æ–º–∏–Ω–∞–Ω–∏–π** ‚Äî –£–ø–æ–º–∏–Ω–∞–Ω–∏—è @username —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
- üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤** ‚Äî –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ª–∞–π–∫–æ–≤, –æ—Ç–≤–µ—Ç–æ–≤ –∏ –≤–æ–≤–ª–µ—á—ë–Ω–Ω–æ—Å—Ç–∏
- ‚ö° **–°–æ–±—ã—Ç–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏** ‚Äî –°–æ–±—ã—Ç–∏—è Kafka –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö

---

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **–§—Ä–µ–π–º–≤–æ—Ä–∫:** NestJS 10+
- **–Ø–∑—ã–∫:** TypeScript 5.0+
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** MongoDB 7+
- **ODM:** Mongoose / @nestjs/mongoose
- **–í–∞–ª–∏–¥–∞—Ü–∏—è:** class-validator + class-transformer
- **–°–æ–±—ã—Ç–∏—è:** Kafka (@nestjs/microservices)
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** Jest + Supertest
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** Swagger/OpenAPI

---

## üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```mermaid
flowchart LR
    Gateway["API Gateway<br/>Go + Fiber"] --> Comment["Comment Service<br/>NestJS + TypeScript"]
    Comment --> MongoDB[("MongoDB<br/>–ö–æ–ª–ª–µ–∫—Ü–∏—è Comments")]
    Comment --> Kafka[("Kafka<br/>–°–æ–±—ã—Ç–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤")]
    
    Kafka -.->|"comment.created"| Notification["Notification Service<br/>NestJS"]
    Kafka -.->|"comment.liked"| Notification
    Kafka -.->|"mention.created"| Notification
    
    Post["Post Service<br/>Go"] -.->|"–í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ—Å—Ç–æ–≤"| Comment
```

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js 20+
- pnpm (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) –∏–ª–∏ npm
- MongoDB 7+
- Docker & Docker Compose (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:**
   ```bash
   git clone https://github.com/A4AD-team/comment-service.git
   cd comment-service
   ```

2. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**
   ```bash
   pnpm install
   # –∏–ª–∏: npm install
   ```

3. **–ó–∞–ø—É—Å–∫ MongoDB:**
   ```bash
   docker compose up -d mongodb
   ```

4. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
   ```bash
   cp .env.example .env
   # –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Å–æ —Å—Ç—Ä–æ–∫–æ–π –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ MongoDB
   ```

5. **–ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞:**
   ```bash
   # –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å –≥–æ—Ä—è—á–µ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π
   pnpm run start:dev

   # –ü—Ä–æ–¥–∞–∫—à–µ–Ω-—Å–±–æ—Ä–∫–∞
   pnpm run build
   pnpm run start:prod
   ```

–°–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É `http://localhost:8084`

---

## üîß –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è |
|------------|----------|----------------------|--------------|
| `NODE_ENV` | –û–∫—Ä—É–∂–µ–Ω–∏–µ (development, production) | `development` | –ù–µ—Ç |
| `PORT` | –ü–æ—Ä—Ç HTTP-—Å–µ—Ä–≤–µ—Ä–∞ | `8084` | –ù–µ—Ç |
| `MONGODB_URI` | –°—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ MongoDB | `mongodb://localhost:27017/comment_db` | –î–∞ |
| `MONGODB_DB_NAME` | –ò–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö MongoDB | `comment_db` | –ù–µ—Ç |
| `JWT_SECRET` | –°–µ–∫—Ä–µ—Ç –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ JWT | `` | –î–∞ |
| `KAFKA_BROKERS` | –ê–¥—Ä–µ—Å–∞ –±—Ä–æ–∫–µ—Ä–æ–≤ Kafka | `localhost:9092` | –ù–µ—Ç |
| `KAFKA_CLIENT_ID` | ID –∫–ª–∏–µ–Ω—Ç–∞ Kafka | `comment-service` | –ù–µ—Ç |
| `KAFKA_GROUP_ID` | –ì—Ä—É–ø–ø–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π Kafka | `comment-service-group` | –ù–µ—Ç |
| `MAX_COMMENT_DEPTH` | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏ | `10` | –ù–µ—Ç |
| `MAX_COMMENT_LENGTH` | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è | `10000` | –ù–µ—Ç |
| `COMMENTS_PER_PAGE` | –õ–∏–º–∏—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é | `50` | –ù–µ—Ç |
| `ENABLE_SOFT_DELETE` | –í–∫–ª—é—á–µ–Ω–∏–µ –º—è–≥–∫–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è | `true` | –ù–µ—Ç |
| `LOG_LEVEL` | –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è | `info` | –ù–µ—Ç |
| `SWAGGER_ENABLED` | –í–∫–ª—é—á–µ–Ω–∏–µ Swagger-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ | `true` | –ù–µ—Ç |

---

## üì° –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏

| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ | –¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è |
|-------|------|----------|----------------------|
| `GET` | `/api/v1/comments` | –°–ø–∏—Å–æ–∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∫ –ø–æ—Å—Ç—É (query: `?postId=xxx`) | –ù–µ—Ç |
| `POST` | `/api/v1/comments` | –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π | –î–∞ |
| `GET` | `/api/v1/comments/:id` | –ü–æ–ª—É—á–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å –æ—Ç–≤–µ—Ç–∞–º–∏ | –ù–µ—Ç |
| `PATCH` | `/api/v1/comments/:id` | –û–±–Ω–æ–≤–∏—Ç—å —Å–≤–æ–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π | –î–∞ |
| `DELETE` | `/api/v1/comments/:id` | –ú—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å–≤–æ–µ–≥–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è | –î–∞ |
| `POST` | `/api/v1/comments/:id/like` | –õ–∞–π–∫–Ω—É—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π | –î–∞ |
| `DELETE` | `/api/v1/comments/:id/like` | –£–±—Ä–∞—Ç—å –ª–∞–π–∫ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è | –î–∞ |

### Query-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|----------|----------|----------------------|
| `postId` | –§–∏–ª—å—Ç—Ä –ø–æ ID –ø–æ—Å—Ç–∞ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è —Å–ø–∏—Å–∫–∞ |
| `limit` | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É | `50` |
| `cursor` | –ö—É—Ä—Å–æ—Ä –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ | `` |
| `sort` | –ü–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏: `newest`, `oldest`, `popular` | `newest` |
| `includeDeleted` | –í–∫–ª—é—á–∞—Ç—å –º—è–≥–∫–æ —É–¥–∞–ª—ë–Ω–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ | `false` |

### –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º

```json
{
  "id": "comment-uuid",
  "postId": "post-uuid",
  "parentCommentId": null,
  "authorId": "user-uuid",
  "author": {
    "username": "johndoe",
    "avatarUrl": "https://cdn.example.com/avatars/johndoe.png"
  },
  "content": "–û—Ç–ª–∏—á–Ω—ã–π –ø–æ—Å—Ç! –°–ø–∞—Å–∏–±–æ –∑–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏—é.",
  "mentions": [],
  "likesCount": 15,
  "isLikedByMe": true,
  "repliesCount": 3,
  "isDeleted": false,
  "createdAt": "2026-02-11T10:30:00Z",
  "updatedAt": "2026-02-11T10:30:00Z",
  "replies": [
    {
      "id": "reply-uuid",
      "parentCommentId": "comment-uuid",
      "authorId": "user-uuid-2",
      "content": "–°–æ–≥–ª–∞—Å–µ–Ω! –û—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω–æ.",
      "likesCount": 5,
      "isDeleted": false
    }
  ]
}
```

---

## ü©∫ Health Checks

| –≠–Ω–¥–ø–æ–∏–Ω—Ç | –ú–µ—Ç–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-------|----------|
| `/health` | `GET` | –û–±—â–∏–π —Å—Ç–∞—Ç—É—Å –∑–¥–æ—Ä–æ–≤—å—è |
| `/health/live` | `GET` | Liveness-–ø—Ä–æ–±–∞ |
| `/health/ready` | `GET` | Readiness-–ø—Ä–æ–±–∞ (–ø—Ä–æ–≤–µ—Ä–∫–∞ MongoDB) |
| `/api/docs` | `GET` | Swagger-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API |

### –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞

```json
{
  "status": "ok",
  "timestamp": "2026-02-12T15:30:00Z",
  "version": "0.1.0",
  "checks": {
    "mongodb": "connected",
    "kafka": "connected"
  }
}
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
pnpm test

# –ó–∞–ø—É—Å–∫ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
pnpm test -- --coverage

# –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è
pnpm test:watch

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞
pnpm test -- comment.service.spec

# –ó–∞–ø—É—Å–∫ e2e —Ç–µ—Å—Ç–æ–≤
pnpm test:e2e
```

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT ‚Äî –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ —Ñ–∞–π–ª–µ [LICENSE](LICENSE).

---

<p align="center">
  <strong>–°–æ–∑–¥–∞–Ω–æ —Å ‚ù§Ô∏è –∫–æ–º–∞–Ω–¥–æ–π A4AD</strong>
</p>
